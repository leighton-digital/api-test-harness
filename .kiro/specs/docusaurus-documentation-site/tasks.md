# Implementation Plan: Docusaurus Documentation Site

## Overview

This implementation plan breaks down the setup of a Docusaurus documentation site for the API Test Harness project into discrete, actionable tasks. Each task builds on previous steps to create a complete, deployable documentation site that mirrors the lambda-toolkit structure.

The implementation follows this sequence:
1. Set up the basic Docusaurus project structure
2. Configure Docusaurus for GitHub Pages deployment
3. Integrate TypeDoc for API documentation
4. Create documentation content
5. Apply custom branding and styling
6. Verify and test the complete setup

## Tasks

- [x] 1. Initialize Docusaurus project structure
  - [x] 1.1 Create docs-site directory and basic structure
    - Create `api-test-harness/docs-site/` directory
    - Create subdirectories: `src/`, `src/css/`, `src/pages/`, `static/`, `static/img/`, `docs/`
    - Create `.gitignore` file with Docusaurus-specific ignores (node_modules, .docusaurus, build)
    - _Requirements: 1.1, 8.3, 10.1, 10.2_

  - [x] 1.2 Create package.json with dependencies and scripts
    - Create `docs-site/package.json` with name, version, and private flag
    - Add dependencies: @docusaurus/core@3.9.2, @docusaurus/preset-classic@3.9.2, @mdx-js/react@3.1.1, prism-react-renderer@2.4.1, react@19.2.4, react-dom@19.2.4
    - Add devDependencies: @docusaurus/module-type-aliases@3.9.2, @docusaurus/tsconfig@3.9.2, @docusaurus/types@3.9.2, typescript@5.9.3, typedoc, typedoc-plugin-markdown
    - Add scripts: start, build, serve, deploy, clear, typecheck, preinstall (with pnpm enforcement)
    - Add engines field specifying Node.js >= 18.0
    - Add browserslist configuration for production and development
    - _Requirements: 1.2, 1.3, 1.4, 7.1, 7.2, 7.3, 7.4, 7.5, 7.6, 9.1, 9.2, 9.3, 9.4, 9.5, 9.6_

  - [x] 1.3 Create TypeScript configuration
    - Create `docs-site/tsconfig.json` extending @docusaurus/tsconfig
    - Configure compiler options for Docusaurus compatibility
    - _Requirements: 1.5_

- [x] 2. Configure Docusaurus for GitHub Pages
  - [x] 2.1 Create docusaurus.config.ts with basic settings
    - Create `docs-site/docusaurus.config.ts` file
    - Configure title: "API Test Harness"
    - Configure tagline: "A CDK based API test harness for returning predefined deterministic responses"
    - Configure favicon using Leighton favicon URL
    - Set future.v4 flag to true
    - Configure i18n with default locale 'en'
    - _Requirements: 1.6, 4.3, 4.4_

  - [x] 2.2 Configure GitHub Pages deployment settings
    - Set url: "https://leighton-digital.github.io"
    - Set baseUrl: "/api-test-harness/"
    - Set organizationName: "leighton-digital"
    - Set projectName: "api-test-harness"
    - Set onBrokenLinks: "warn"
    - Set onBrokenMarkdownLinks: "warn"
    - _Requirements: 1.6, 5.1, 5.2, 5.3, 5.5_

  - [x] 2.3 Configure preset-classic
    - Add preset-classic configuration with docs path: './docs'
    - Set routeBasePath: '/' to serve docs at site root
    - Set sidebarPath: './sidebars.ts'
    - Disable blog feature (blog: false)
    - Configure theme with customCss: './src/css/custom.css'
    - _Requirements: 1.6_

  - [x] 2.4 Configure navbar and footer
    - Configure navbar with title "API Test Harness"
    - Add navbar logo configuration pointing to 'img/api-test-harness-logo.png'
    - Add navbar items: Documentation link (docSidebar type) and GitHub link
    - Configure footer with dark style
    - Add footer links: Documentation section and Community section (GitHub Issues)
    - Add footer copyright: "Copyright Â© {year} Leighton. Built with Docusaurus."
    - _Requirements: 4.1, 4.5, 6.1, 6.2, 6.3, 6.4, 10.5_

  - [x] 2.5 Configure Prism syntax highlighting
    - Set prism theme to prismThemes.github
    - Set prism darkTheme to prismThemes.dracula
    - _Requirements: 1.6_

- [x] 3. Integrate TypeDoc for API documentation
  - [x] 3.1 Configure TypeDoc plugin in docusaurus.config.ts
    - Add typedoc-plugin-markdown to plugins array
    - Configure entryPoints: ['../src/index.ts']
    - Configure tsconfig: '../tsconfig.json'
    - Configure out: 'api-reference'
    - Configure sidebar with categoryLabel: 'API Reference' and position: 10
    - _Requirements: 2.1, 2.3, 2.4, 2.5_

  - [ ]* 3.2 Test TypeDoc generation
    - Run build command to verify TypeDoc generates API documentation
    - Verify api-reference directory is created in docs/
    - Verify API documentation appears in sidebar navigation
    - _Requirements: 2.2_

- [x] 4. Create sidebar configuration
  - [x] 4.1 Create sidebars.ts with autogenerated structure
    - Create `docs-site/sidebars.ts` file
    - Configure autogenerated sidebar with dirName: '.'
    - Export sidebars configuration
    - _Requirements: 1.7, 3.8, 6.5_

- [x] 5. Set up static assets
  - [x] 5.1 Copy logo and create .nojekyll file
    - Copy `../images/api-test-harness-logo.png` to `static/img/api-test-harness-logo.png`
    - Create empty `.nojekyll` file in `static/` directory
    - _Requirements: 4.1, 5.4, 8.5, 10.3, 10.4_

- [x] 6. Create custom styling
  - [x] 6.1 Create custom.css with branding
    - Create `src/css/custom.css` file
    - Define CSS custom properties for primary colors
    - Add font imports for Montserrat and Euclid Circular A
    - Configure code font size and highlighted line background
    - Add any custom styles for logo, navigation, or layout
    - _Requirements: 4.2_

- [x] 7. Create documentation content
  - [x] 7.1 Create Getting Started guide
    - Create `docs/getting-started.md`
    - Include introduction to API Test Harness
    - Explain why the test harness is needed
    - Include quick start instructions
    - Reference content from main README.md
    - _Requirements: 3.1, 8.4_

  - [x] 7.2 Create Installation guide
    - Create `docs/installation.md`
    - Include npm installation command
    - Include pnpm installation command
    - List prerequisites (Node.js version, AWS CDK)
    - Include basic import example
    - _Requirements: 3.2, 8.4_

  - [x] 7.3 Create Configuration guide
    - Create `docs/configuration.md`
    - Document all configuration options (stage, loggerEnabled, logLevel, etc.)
    - Include configuration table from README
    - Provide configuration examples
    - Explain default values
    - _Requirements: 3.3, 8.4_

  - [x] 7.4 Create Usage Examples guide
    - Create `docs/usage-examples.md`
    - Include basic CDK stack example from README
    - Show how to integrate into existing CDK projects
    - Demonstrate different configuration scenarios
    - Include code examples with proper syntax highlighting
    - _Requirements: 3.4, 8.4_

  - [x] 7.5 Create Seeding Data guide
    - Create `docs/seeding-data.md`
    - Explain how to seed DynamoDB with test data
    - Include example DynamoDB item JSON from README
    - Show AWS SDK examples for seeding
    - Show AWS CLI examples for seeding
    - Explain pk/sk structure and response format
    - _Requirements: 3.5, 8.4_

  - [x] 7.6 Create Architecture overview
    - Create `docs/architecture.md`
    - Include solution diagram from README (reference ../images/solution.png)
    - Explain the overall architecture and data flow
    - Document the Lambda Function URL approach
    - Explain API key generation and security
    - Describe DynamoDB table structure
    - _Requirements: 3.6, 8.4_

- [x] 8. Checkpoint - Verify documentation site builds
  - Ensure all tests pass, ask the user if questions arise.
  - Run `pnpm install` in docs-site directory
  - Run `pnpm build` to verify site builds successfully
  - Run `pnpm start` to verify site runs locally
  - Check that all documentation pages are accessible
  - Verify API reference documentation is generated
  - Verify logo and branding display correctly

- [x] 9. Create integration tests
  - [ ]* 9.1 Write tests for file structure
    - Create test file `tests/docs-site-setup.test.ts`
    - Test that docs-site directory exists
    - Test that all required subdirectories exist (src, static, docs, etc.)
    - Test that all required files exist (package.json, docusaurus.config.ts, sidebars.ts, tsconfig.json)
    - **Property 1: Directory Structure Completeness**
    - **Validates: Requirements 1.1, 1.5, 1.7, 8.3, 10.1, 10.2**

  - [ ]* 9.2 Write tests for package.json configuration
    - Test Docusaurus version is 3.9.2
    - Test all required scripts exist (start, build, serve, deploy, clear, typecheck)
    - Test pnpm preinstall script exists
    - Test React version is 19.2.4
    - Test TypeScript version is 5.9.3
    - Test Node.js engine requirement is >= 18.0
    - Test browserslist configuration exists
    - **Property 2: Docusaurus Version Correctness**
    - **Property 3: Package Manager Configuration**
    - **Property 4: Required Scripts Presence**
    - **Property 14: Dependency Versions**
    - **Property 15: Browserslist Configuration**
    - **Validates: Requirements 1.2, 1.3, 1.4, 7.1-7.6, 9.1-9.6**

  - [ ]* 9.3 Write tests for Docusaurus configuration
    - Parse docusaurus.config.ts and validate structure
    - Test url is "https://leighton-digital.github.io"
    - Test baseUrl is "/api-test-harness/"
    - Test organizationName is "leighton-digital"
    - Test projectName is "api-test-harness"
    - Test title is "API Test Harness"
    - Test tagline exists
    - Test navbar logo configuration
    - Test navbar items include Documentation and GitHub links
    - Test footer includes Leighton branding
    - Test TypeDoc plugin configuration
    - **Property 5: GitHub Pages Deployment Configuration**
    - **Property 6: TypeDoc Integration**
    - **Property 9: Branding Configuration**
    - **Property 11: Footer Branding**
    - **Property 12: Navigation Bar Links**
    - **Validates: Requirements 1.6, 2.1-2.5, 4.1, 4.3-4.5, 5.1-5.5, 6.1-6.4, 10.5**

  - [ ]* 9.4 Write tests for static assets
    - Test .nojekyll file exists in static/
    - Test api-test-harness-logo.png exists in static/img/
    - Test logo file is copied from ../images/
    - **Property 13: Static Assets Setup**
    - **Property 17: Image References**
    - **Validates: Requirements 5.4, 8.5, 10.3, 10.4**

  - [ ]* 9.5 Write tests for documentation content
    - Test all required documentation files exist
    - Test getting-started.md exists
    - Test installation.md exists
    - Test configuration.md exists
    - Test usage-examples.md exists
    - Test seeding-data.md exists
    - Test architecture.md exists
    - **Property 7: Documentation Files Existence**
    - **Validates: Requirements 3.1-3.6**

  - [ ]* 9.6 Write tests for main project preservation
    - Test that src/ directory in root is unchanged
    - Test that root package.json is unchanged
    - Compare file modification times or content hashes
    - **Property 16: Main Project Preservation**
    - **Validates: Requirements 8.1, 8.2**

  - [ ]* 9.7 Write build integration test
    - Test that `pnpm build` command succeeds
    - Test that build/ directory is created
    - Test that API reference documentation is generated
    - **Validates: Requirements 2.2, 3.7**

- [x] 10. Final checkpoint - Complete verification
  - Ensure all tests pass, ask the user if questions arise.
  - Run all unit tests and verify they pass
  - Build the documentation site and verify no errors
  - Manually review the site in a browser
  - Verify all links work correctly
  - Verify logo and branding are correct
  - Verify API documentation is generated and accessible
  - Test deployment command (without actually deploying)

## Notes

- Tasks marked with `*` are optional test tasks and can be skipped for faster MVP
- Each task references specific requirements for traceability
- Checkpoints ensure incremental validation
- The docs-site is completely self-contained and won't affect the main project
- All configuration files use TypeScript for type safety
- The structure mirrors lambda-toolkit for consistency
- Documentation content is derived from the existing README.md
